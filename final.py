import random
import requests
from bs4 import BeautifulSoup

class Currency:
    def __init__(self):
        self.url = "https://minfin.com.ua/ua/currency/"
        self.data = {}
    def get_rates(self):
        response = requests.get(self.url, headers={'User-Agent': 'Mozilla/5.0'})
        soup = BeautifulSoup(response.text, "html.parser")
        table = soup.find("table")
        rows = table.find_all("tr")
        for row in rows:
            cols = row.find_all("td")
            if len(cols) >= 3:
                name = cols[0].text
                buy = cols[1].text
                sell = cols[2].text
                self.data[name] = (buy, sell)
    def show(self):
        print("---------------------------------------------------------------------------------------------")
        print("Поточні курси валют:")
        for name, (buy, sell) in self.data.items():
            print(f"{name}: Купвати — {buy} і Продавати — {sell}")
        print("---------------------------------------------------------------------------------------------")
c = Currency()  
name_make = None
pass_make = None
money = random.randint(1, 1000)
print('Вітаю! Я буду вашим віртуальним консультантом у YourBankUA.')
print('---------------------------------------------------------------------------------------------')
print('Схоже, Ви не увійшли у вас немає акаунту або ви у нього не увійшли.')
ask1 = input('Введіть *увійти* якщо у вас уже є акаунт, якщо ж його немає - *створити*: ')
print('---------------------------------------------------------------------------------------------')

accounts = {"Ларіса": '12345', 'Федько': '12342', 'Стефані': '12348', 'Степан': '123450'}
if ask1 == 'увійти':
  
    print('Ви вибрали увійти.')           
    try:
        while True:
            ask_1_name = input('Уведіть ваше імя: ')
            try:
                if ask_1_name in accounts:
                    print('---------------------------------------------------------------------------------------------')
                    print('Звіряюся з базою данних..')
                    print('Таке імя є. Переходимо до наступного етапу ідентифікації')
                    print('---------------------------------------------------------------------------------------------')
                    try:
                        while True:
                            ask_1_pass = input(f'Введіть пароль від вашого акаунту, {ask_1_name}: ')
                            try: 
                                if ask_1_pass == accounts[ask_1_name]:
                                    print('---------------------------------------------------------------------------------------------')
                                    print('Звіряюся з базою данних..')
                                    print(f'Ви успішно увійшли в акаунт! Вітаємо, {ask_1_name}.')
                                    print('---------------------------------------------------------------------------------------------')
                                    print(f'Вітаю вас. {name_make}')
                                    print('---------------------------------------------------------------------------------------------')
                                    break
                                else:
                                    print('---------------------------------------------------------------------------------------------')
                                    print('Звіряюся з базою данних..')
                                    print("Введіть пароль знову")
                                    print('---------------------------------------------------------------------------------------------')
                            except:
                                print('---------------------------------------------------------------------------------------------')
                                print("Сталася помилка")
                                print('---------------------------------------------------------------------------------------------')
                        break
                    except:
                        print('---------------------------------------------------------------------------------------------')
                        print("Сталася помилка")
                        print('---------------------------------------------------------------------------------------------')
                else:
                    print('---------------------------------------------------------------------------------------------')
                    print('Звіряюся з базою данних..')
                    print('Введіть імя знову.')
                    print('---------------------------------------------------------------------------------------------')
            except: 
                print('---------------------------------------------------------------------------------------------')
                print("Сталася помилка")
                print('---------------------------------------------------------------------------------------------')
    except:
        print('---------------------------------------------------------------------------------------------')
        print('Cталася помилка')
        print('---------------------------------------------------------------------------------------------')

elif ask1 == 'створити':
    try: 
        while True:
            name_make = input('Введіть своє імя: ')
            if name_make in accounts:
                print('---------------------------------------------------------------------------------------------')
                print('Звіряюся з базою данних..')
                print('Таке імя вже зареєстроване. Введіть інше.')
                print('---------------------------------------------------------------------------------------------')
            else: 
                print('---------------------------------------------------------------------------------------------')
                print('Звіряюся з базою данних..')
                print('Імя не зайняте. Уведіть пароль до свого акаунту.')
                print('---------------------------------------------------------------------------------------------')
                try:
                    pass_make = input(f'Введіть пароль для акаунту {name_make}: ')
                    print('---------------------------------------------------------------------------------------------')
                    print('Звіряюся з базою данних..')
                    print(f'Акаунт {name_make} успішно створено! Тепер ви можете увійти під ним.')
                    print('---------------------------------------------------------------------------------------------')
                    print(f'Вітаю вас. {name_make}')
                    print('---------------------------------------------------------------------------------------------')

                    break
                except:
                    print('---------------------------------------------------------------------------------------------')
                    print('Сталася помилка.')
                    print('---------------------------------------------------------------------------------------------')
    except:
        print('---------------------------------------------------------------------------------------------')
        print('Cталася помилка')
        print('---------------------------------------------------------------------------------------------')

else: 
    print('---------------------------------------------------------------------------------------------')
    print('Cталася помилка')
    print('---------------------------------------------------------------------------------------------')
    exit()


while True:
    print(f'На вашому рахунку: {money}')
    print('Перед вами опції нашого меню: ')
    print(' - Вивести певну суму з мого рахунку (напишіть 1)')
    print(' - Поповнити свій рахунок (напишіть 2)')
    print(' - Переказати кошти на певний рахунок (напишіть 3)')
    print(' - Подивитися валюти (напишіть 4)')
    print(' - Вийти з меню (напишіть 5)')
    ask2 = int(input(' Ваш вибір: '))
    print('---------------------------------------------------------------------------------------------')
    if ask2 == 1:
        print(' Ви вибрали вивести певну суму з мого рахунок.')
        try:
                if money <= 0:
                    print('---------------------------------------------------------------------------------------------')
                    print(f'На вашому рахунку {money}, тому ми не можемо вивести ваші кошти. Поповнітб рахунок і поверніться на сторінку, якщо бажаєте продовжити.')
                    print('---------------------------------------------------------------------------------------------')
                
                if money > 0:
                    print('---------------------------------------------------------------------------------------------')
                    print(f'Ваш рахунок {money}')
                    minus_money = int(input('Скільки бажаєте вивести: '))
                    print('---------------------------------------------------------------------------------------------')
                    money -= minus_money
                    print(f'Ваш рахунок: {money}')
                    print('---------------------------------------------------------------------------------------------')
                    if money <= 0:
                        print('На вашому рахунку немає грошей, обо ви у мінусі! Поповніть його.')
                    else: 
                        pass
        except:
            print('---------------------------------------------------------------------------------------------')
            print('Cталася помилка')
            print('---------------------------------------------------------------------------------------------')
    elif ask2 == 2:
        print(' Ви вибрали поповнити свій рахунок.')
        try:
            print('---------------------------------------------------------------------------------------------')
            print(f'На вашому рахунку {money}.')
            minus_money = int(input('На яку суму бажаєте поповнити ваш рахунок: '))
            print('---------------------------------------------------------------------------------------------')
            money += minus_money
            print(f'Ваш рахунок: {money}')
            print('---------------------------------------------------------------------------------------------')
        except:
            print('---------------------------------------------------------------------------------------------')
            print('Cталася помилка')
            print('---------------------------------------------------------------------------------------------')
    elif ask2 == 3:
        print(' Ви вибрали переказати певну суму з мого рахуноку.')
        try: 
            while True:
                if money <= 0:
                    print('---------------------------------------------------------------------------------------------')
                    print(f'На вашому рахунку {money}, тому ми не можемо вивести ваші кошти. Поповнітб рахунок і поверніться на сторінку, якщо бажаєте продовжити.')
                    print('---------------------------------------------------------------------------------------------')
                while True:
                    if money > 0:
                        print('---------------------------------------------------------------------------------------------')
                        print(f'Ваш рахунок {money}')
                        acc = input('Користувач якому бажаєте переказати ваші кошти: ')
                        print('---------------------------------------------------------------------------------------------')
                        if acc not in accounts:
                            print('---------------------------------------------------------------------------------------------')
                            print(f'Користувача {acc} не знайдено.')
                            print('---------------------------------------------------------------------------------------------')           
                        else: 
                            print('---------------------------------------------------------------------------------------------')
                            print(f'Користувача {acc} знайдено.')
                            print('---------------------------------------------------------------------------------------------')
                            break
                break        
        except:
            print('---------------------------------------------------------------------------------------------')
            print('Cталася помилка')
            print('---------------------------------------------------------------------------------------------')

        try: 
            while True:
                print('---------------------------------------------------------------------------------------------')
                print(f'Ваш рахунок {money}')
                money_perecas = int(input(f'Кошти які бажаєте переказати {acc}: '))
                print('---------------------------------------------------------------------------------------------')   
                money -= money_perecas
                if money <= 0:
                    print('---------------------------------------------------------------------------------------------')
                    print(f'На вашому рахунку {money}, тому ми не можемо вивести ваші кошти. Поповнітб рахунок і поверніться на сторінку, якщо бажаєте продовжити.')
                    print('---------------------------------------------------------------------------------------------')
                else:
                    print('---------------------------------------------------------------------------------------------')
                    print('Успішно.')
                    print('---------------------------------------------------------------------------------------------')
                break
        except:
            print('---------------------------------------------------------------------------------------------')
            print('Cталася помилка')
            print('---------------------------------------------------------------------------------------------') 

    elif ask2 == 4:
        print('---------------------------------------------------------------------------------------------')   
        print('Ви вибрали подивитися валюти.')
        print('---------------------------------------------------------------------------------------------')   
        c.get_rates()     
        c.show() 
 
    elif ask2 == 5:
        exit()
        
    else:
        print('---------------------------------------------------------------------------------------------')
        print('Cталася помилка')
        print('---------------------------------------------------------------------------------------------') 










# if ask1 == 'увійти':
#     accounts = {"Ларіса": '12345', 'Федько': '12342', 'Стефані': '12348', 'Степан': '123450'}
#     print('Ви вибрали увійти.')
#     ask_1_name = input('Уведіть ваше імя: ')
#     if ask_1_name not in accounts:
#         print('Звіряюся з базою данних..')
#         tries -= 1 
#         print('Такого імені немає. Входьте знову. У вас є ще 2 спроби')
        
            
#     elif ask_1_name in accounts:
#         ask_1_passw = input('Уведіть ваш пароль: ')
#         if ask_1_passw not in accounts(ask_1_name):
#             print('Звіряюся з базою данних..')
#             print('Неправильний пароль.')
#         if ask_1_passw in accounts(ask_1_name):
#             print('Звіряюся з базою данних..')
#             print(f'Ви успішно увійшли. Вітаю {accounts(ask_1_name), accounts(ask_1_passw)} ')
#             pass
